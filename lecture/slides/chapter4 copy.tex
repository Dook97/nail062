


\section{Korektnost a úplnost}

V této sekci dokážeme, že je tablo metoda \emph{korektní} a \emph{úplný} dokazovací systém, tj. že $T\proves\varphi$ platí právě když $T\models\varphi$.

\subsection{Věta o korektnosti}

Řekneme, model $v$ se \emph{shoduje} s položkou $P$, pokud
$P=\mathrm{T}\varphi$ a $v\models\varphi$, nebo $P=\mathrm{F}\varphi$ a $v\not\models\varphi$. Dále $v$ se shoduje s větví $V$, pokud se shoduje s každou položkou na této větvi.

Jak už jsme zmínili, design atomických tabel zaručuje, že shoduje-li se model s položkou v kořeni tabla, shoduje se s některou větví. Není těžké indukcí podle konstrukce tabla ukázat následující lemma:
\begin{lemma}\label{lemma:agrees-with-branch}
    Shoduje-li se model teorie $T$ s položkou v kořeni tabla z teorie $T$, potom se shoduje s některou větví.
\end{lemma}
\begin{proof}
    Mějme tablo $\tau=\bigcup_{i\geq 0}\tau_i$ z teorie $T$ a model $v\in\M(T)$ shodující se s kořenem $\tau$, tedy s (jednoprvkovou) větví $V_0$ v (jednoprvkovém) $\tau_0$.
    
    Indukcí podle $i$ (podle kroků v při konstrukci tabla) najdeme posloupnost $V_0\subseteq V_1\subseteq\dots$ takovou, že $V_i$ je větev v tablu $\tau_i$ shodující se s modelem $v$, a $V_{i+1}$ je prodloužením $V_i$. Požadovaná větev tabla $\tau$ je potom $V=\bigcup_{i\geq 0}V_i$.
    
    \begin{itemize}
        \item Pokud $\tau_{i+1}$ vzniklo z $\tau_i$ bez prodloužení větve $V_i$, definujeme $V_{i+1}=V_i$.
        \item Pokud $\tau_{i+1}$ vzniklo z $\tau_i$ připojením položky $\mathrm{T}\alpha$ (pro nějaký axiom $\alpha\in T$) na konec větve  $V_i$, definujeme $V_{i+1}$ jako tuto prodlouženou větev. Protože $v$ je model $T$, platí v něm axiom $\alpha$, tedy shoduje se i s novou položkou $\mathrm{T}\alpha$.
        \item Nechť $\tau_{i+1}$ vzniklo z $\tau_i$ připojením atomického tabla pro nějakou položku $P$ na konec větve $V_i$. Protože se model $v$ shoduje s položkou $P$ (která leží na větvi $V_i$), shoduje se i s kořenem připojeného atomického tabla, a proto se shoduje i s některou z jeho větví. (Tuto vlastnost snadno ověříme pro všechna atomická tabla.) Definujeme $V_{i+1}$ jako prodloužení $V_i$ o tuto větev atomického tabla.\footnote{Resp. o libovolnou takovou větev: model $v$ se může shodovat s více větvemi atomického tabla.}
    \end{itemize}
\end{proof}

Nyní už můžeme dokázat Větu o korektnosti. Zkráceně řečeno, pokud by existoval důkaz a zároveň protipříklad, protipříklad by se musel shodovat s některou větví důkazu, ty jsou ale všechny sporné.

\begin{theorem}[O korektnosti]
Je-li výrok $\varphi$ tablo dokazatelný z teorie $T$, potom je $\varphi$ pravdivý v $T$, tj. $T\proves\varphi\ \Rightarrow\ T\models\varphi$.    
\end{theorem}

\begin{proof}
Dokážeme sporem. Předpokládejme, že $\varphi$ v $T$ neplatí, tj. existuje protipříklad: model $v\in\M(T)$, ve kterém $\varphi$ neplatí.

Protože je $\varphi$ dokazatelná z $T$, existuje tablo důkaz $\varphi$ z T, což je sporné tablo z $T$ s položkou $\mathrm{F}\varphi$ v kořeni. Model $v$ se shoduje s položkou $\mathrm{F}\varphi$, tedy podle Lemmatu \ref{lemma:agrees-with-branch} se shoduje s nějakou větví $V$. Všechny větve jsou ale sporné, včetně $V$. Takže $V$ obsahuje položky $\mathrm{T}\psi$ a $\mathrm{F}\psi$ (pro nějaký výrok $\psi$), a model $v$ se s těmito položkami shoduje. Máme tedy $v\models\psi$ a zároveň $v\not\models\psi$, což je spor.

\end{proof}

\subsection{Věta o úplnosti}

Ukážeme, že \emph{bezesporná} větev v \emph{dokončeném} tablo důkazu poskytuje protipříklad: model teorie $T$, který se shoduje s položkou $\mathrm{F}\varphi$ v kořeni tabla, tj. neplatí v něm $\varphi$. Takových modelů může být více, definujeme proto jeden konkrétní:

\begin{definition}[Kanonický model]\label{definition:canonical-model}
Je-li $V$ bezesporná větev dokončeného tabla, potom \emph{kanonický model} pro $V$ je model definovaný předpisem (pro $p\in\mathbb P$):
$$
v(p)=\begin{cases}
    1 \text{ pokud se na $V$ vyskytuje položka $\mathrm{T}p$,}\\
    0 \text{ jinak.}
\end{cases}
$$  
\end{definition}
\begin{lemma}\label{lemma:canonical-model-agrees}
    Kanonický model pro (bezespornou dokončenou) větev $V$ se shoduje s $V$.
\end{lemma}
\begin{proof}
Ukážeme, že kanonický model $v$ se shoduje se všemi položkami $P$ na větvi $V$, a to indukcí podle struktury výroku v položce.\footnote{Připomeňme, že to znamená indukci podle hloubky stromu výroku.} Nejprve základ indukce:
\begin{itemize}
    \item Je-li $P=\mathrm{T}p$ pro nějaký prvovýrok $p\in\mathbb P$, máme podle definice $v(p)=1$; $v$ se s $P$ shoduje.
    \item Je-li $P=\mathrm{F}p$, potom se na větvi $V$ nemůže vyskytovat položka $\mathrm{T}p$, jinak by $V$ byla sporná. Podle definice máme $v(p)=0$ a $v$ se s $P$ opět shoduje.
\end{itemize}
Nyní indukční krok. Rozebereme dva případy, ostatní se dokáží obdobně.
\begin{itemize}
    \item Nechť $P=\mathrm{T}\varphi\land\psi$. Protože je $V$ dokončená větev, je na ní položka $P$ redukovaná. To znamená, že se na $V$ vyskytují i položky $\mathrm{T}\varphi$ a $\mathrm{T}\psi$. Podle indukčního předpokladu se s nimi model $v$ shoduje, tedy $v\models\varphi$ a $v\models\psi$. Takže platí i $v\models\varphi\land\psi$ a $v$ se shoduje s $P$.
    \item Nechť $P=\mathrm{F}\varphi\land\psi$. Protože je $P$ na $V$ redukovaná, vyskytuje se na $V$ položka $\mathrm{F}\varphi$ nebo položka $\mathrm{F}\psi$. Platí tedy $v\not\models\varphi$ nebo $v\not\models\psi$, z čehož plyne $v\not\models\varphi\land\psi$ a $v$ se shoduje s $P$.
\end{itemize}
\end{proof}

\begin{theorem}[O úplnosti]
    Je-li výrok $\varphi$ pravdivý v teorii $T$, potom je tablo dokazatelný z $T$, tj. $T\models\varphi\ \Rightarrow\ T\proves\varphi$.    
\end{theorem}

\begin{proof}
Ukážeme, že libovolné \emph{dokončené} (tedy např. i \emph{systematické}) tablo z $T$ s položkou $\mathrm{F}\varphi$ v kořeni je nutně sporné. Důkaz provedeme sporem: kdyby takové tablo nebylo sporné, existovala by v něm bezesporná (dokončená) větev $V$. Uvažme kanonický model $v$ pro tuto větev. Protože je $V$ dokončená, obsahuje $\mathrm{T}\alpha$ pro všechny axiomy $\alpha\in T$. Model $v$ se podle Lemmatu \ref{lemma:canonical-model-agrees} shoduje se všemi položkami na $V$, splňuje tedy všechny axiomy a máme $v\models T$. Protože se ale $v$ shoduje i s položkou $\mathrm{F}\varphi$ v kořeni, máme $v\not\models\varphi$, což znamená, že $T\not\models\varphi$, spor. Tablo tedy muselo být sporné, tj. být tablo důkazem $\varphi$ z $T$.
\end{proof}

\begin{proof}[Důkaz Důsledku \ref{corollary:systematicity-of-proofs}]
Z předchozího důkazu také dostáváme `systematičnost důkazů', tj. že důkaz můžeme vždy hledat konstrukcí systematického tabla: Pokud $T\models\varphi$, tak je i systematické tablo pro položku $\mathrm{F}\varphi$ nutně sporné, a je tedy tablo důkazem $\varphi$ z $T$.
\end{proof}

\begin{exercise}
    Ověřte zbývající případy v důkazu Lemmatu \ref{lemma:canonical-model-agrees}.
\end{exercise}

\begin{exercise}
    Popište, jak vypadají \emph{všechny} modely shodující se s danou bezespornou dokončenou větví.
\end{exercise}

\begin{exercise}
    Navrhněte postup, kterým můžeme za použití tablo metody najít všechny modely dané teorie $T$.
\end{exercise}


\section{Důsledky korektnosti a úplnosti}

Věty o korektnosti a úplnosti dohromady říkají, že \emph{dokazatelnost} je totéž, co \emph{platnost}. To nám umožňuje zformulovat syntaktické analogie sémantických pojmů a vlastností.

Analogií \emph{důsledků} jsou \emph{teorémy} teorie $T$:
$$
\Thm_\mathbb P(T)=\{\varphi\in\VF_\mathbb P\mid T\proves\varphi\}
$$

\begin{corollary}[Dokazatelnost = platnost]\label{corollary:corollary-of-soundness-and-completeness}
    Pro libovolnou teorii $T$ a výroky $\varphi,\psi$ platí:
    \begin{itemize}
        \item $T\proves\varphi$ právě když $T\models\varphi$
        \item $\Thm_\mathbb P(T)=\Conseq_\mathbb P(T)$
    \end{itemize}
\end{corollary}
\begin{proof}
    Plyne okamžitě z Věty o korektnosti a z Věty o úplnosti.
\end{proof}


Ve všech definicích a větách můžeme tedy nahradit pojem `\emph{platnost}' pojmem `\emph{dokazatelnost}' (tj. symbol `$\models$' symbolem `$\proves$') a  pojem `\emph{důsledek}' pojmem `\emph{teorém}'. Například:
\begin{itemize}
    \item Teorie je \emph{sporná}, jestliže je v ní dokazatelný spor (tj. $T\proves\bot$).
    \item Teorie je \emph{kompletní}, jestliže pro každý výrok $\varphi$ je buď $T\proves\varphi$ nebo $T\proves\neg\varphi$ (ale ne obojí, jinak by byla sporná).
\end{itemize}

Uveďme ještě jeden snadný důsledek:

\begin{theorem}[O dedukci]
Pro teorii $T$ a výroky $\varphi,\psi$ platí:
$T,\varphi\proves\psi\text{ právě když }T\proves\varphi\to\psi$.
\end{theorem}
\begin{proof}
    Stačí dokázat $T,\varphi\models\psi\Leftrightarrow T\models\varphi\to\psi$, což je snadné.
\end{proof}

\begin{exercise}
Dokažte Větu o dedukci přímo, pomocí transformace tablo důkazů.
\end{exercise}


\section{Věta o kompaktnosti}

Důležitým důsledkem vět o korektnosti a úplnosti je také tzv. \emph{Věta o kompaktnosti}.\footnote{Slovo \emph{kompaktnost} pochází z kompaktních (tj. omezených a uzavřených) množin v Euklidovských prostorech, ve kterých lze z každé posloupnosti vybrat konvergentní podposloupnost. Můžete si představit posloupnost zvětšujících se konečných částí `konvergující' k nekonečnému celku.} Tento princip umožňuje převádět tvrzení o nekonečných objektech/procesech na tvrzení o (všech) jejich konečných částech.

\begin{theorem}[O kompaktnosti]\label{theorem:compactness-theorem}
Teorie má model, právě když každá její konečná část má model.    
\end{theorem}

\begin{proof}
Každý model teorie $T$ je zjevně modelem každé její části. Druhou implikaci dokážeme nepřímým důkazem: Předpokládejme, že $T$ nemá model, tj. je sporná, a najděme konečnou část $T'\subseteq T$, která je také sporná.

Protože je $T$ sporná, platí $T\proves\bot$ (zde potřebujeme Větu o úplnosti). Podle Důsledku \ref{corollary:finiteness-of-proofs} potom existuje \emph{konečný} tablo důkaz $\tau$ výroku $\bot$ z $T$. Konstrukce tohoto důkazu má jen konečně mnoho kroků, použili jsme tedy jen konečně mnoho axiomů z $T$. Definujeme-li $T'=\{\alpha\in T\mid \mathrm{T}\alpha\text{ je položka v tablu $\tau$}\}$, potom $\tau$ je také tablo důkaz sporu z teorie $T'$. Teorie $T'$ je tedy sporná konečná část $T$.
\end{proof}

\subsection{Aplikace kompaktnosti}

Následující jednoduchou aplikaci Věty o kompaktnosti můžete chápat jako šablonu, kterou následuje i mnoho dalších, složitějších aplikací této věty. 

\begin{corollary}\label{corollary:infinite-bipartite-compactness}
Spočetně nekonečný graf je bipartitní, právě když je každý jeho konečný podgraf bipartitní.    
\end{corollary}

\begin{proof}
    Každý podgraf bipartitního grafu je zjevně také bipartitní. Ukažme opačnou implikaci. Graf je bipartitní, právě když je obarvitelný 2 barvami. Označme barvy $0,1$.

    Sestrojíme výrokovou teorii $T$ v jazyce $\mathbb P=\{p_v\mid v\in V(G)\}$, kde hodnota výrokové proměnné $p_v$ reprezentuje barvu vrcholu $v$.
    $$  
        T=\{p_u\limplies\neg p_v\mid \{u,v\}\in E(G)\}
    $$
    Zřejmě platí, že $G$ je bipartitní, právě když $T$ má model. Podle Věty o kompaktnosti stačí ukázat, že každá konečná část $T$ má model. Vezměme tedy konečnou $T'\subseteq T$. Buď $G'$ podgraf $G$ indukovaný na množině vrcholů, o kterých se zmiňuje teorie $T'$, tj. $V(G')=\{v\in V(G)\mid p_v\in\Var(T')\}$. Protože je $T'$ konečná, je $G'$ také konečný, a podle předpokladu je 2-obarvitelný. Libovolné 2-obarvení $V(G')$ ale určuje model teorie $T'$.
\end{proof}

Základem této techniky je popis požadované vlastnosti nekonečného objektu pomocí (nekonečné) výrokové teorie. Dále si všimněte, jak z konečné části teorie sestrojíme konečný podobjekt mající danou vlastnost (v našem případě konečný podgraf, který je bipartitní).

\begin{exercise}
    Zobecněte Důsledek \ref{corollary:infinite-bipartite-compactness} pro více barev, tj. ukažte, že spočetně nekonečný graf je $k$-obarvitelný, právě když je každý jeho konečný podgraf $k$-obarvitelný. (Viz Sekce \ref{subsection:example-graph-coloring}.)
\end{exercise}

\begin{exercise}
    Ukažte, že každé částečné uspořádání na spočetné množině lze rozšířit na lineární uspořádání.
\end{exercise}

\begin{exercise}
    Vyslovte a dokažte `spočetně nekonečnou' analogii Hallovy věty.
\end{exercise}

\section{(draft) Hilbertovský kalkulus}\label{section:hilbert-calculus-propositional}
\todo
Na závěr kapitoly o tablo metodě si pro srovnání ukážeme jiný dokazovací systém, tzv. \emph{hilbertovský deduktivní systém} neboli \emph{hilbertovský kalkulus}. Jde o nejstarší dokazovací systém, modelovaný podle matematických důkazů. Jak uvidíme na příkladě, dokazování je v něm poměrně pracné, hodí se tedy spíše pro teoretické účely. Jde také o korektní a úplný dokazovací systém (to ale necháme bez důkazu).

% from slides:

\begin{itemize}
    \item základní logické spojky: $\neg$, $\to$ (ostatní z nich odvozené)
    
    \item \mdef{logické axiomy} (\myblue{schémata} logických axiomů):
    \vspace{-2mm}\begin{align*}(i)& &\varphi &\to (\psi \to \varphi) \\
    (ii)& &(\varphi\to (\psi \to \chi))&\to ((\varphi \to \psi)\to(\varphi \to \chi))\qquad\qquad\qquad\qquad\phantom{\ } \\
    (iii)& &(\neg \varphi \to \neg \psi)&\to(\psi \to \varphi)
    \end{align*}
    
    \vspace{-2mm}
    kde $\varphi$, $\psi$, $\chi$ jsou libovolné formule (daného jazyka).
    \item \mdef{odvozovací pravidlo}:
    \vspace{-3mm}
    $$\frac{\varphi,\ \varphi \to \psi}{\psi}\qquad\text{\myblue{(modus ponens)}}$$
    \end{itemize}
    
    \vspace{-1mm}
    \mdef{Důkaz} (\emph{Hilbertova stylu}) formule $\varphi$ v teorii $T$ je \myblue{konečná} posloupnost
    \smallskip
    
    $\varphi_0, \dots, \varphi_n=\varphi$ formulí taková, že pro každé $i\le n$
    \begin{itemize}
    \item $\varphi_i$ je logický axiom nebo $\varphi_i \in T$ (axiom teorie), nebo
    \item $\varphi_i$ lze odvodit z předchozích formulí pomocí odvozovacího pravidla.
    \end{itemize}
    
    %$\varphi$ je \mdef{dokazatelná} v $T$, má-li důkaz z $T$. Značíme $T \vdash_{H} \varphi$, popř. $\vdash_H \varphi$ pro $T=\emptyset$.
    \medskip
    
    {\it \myblue{Poznámka}\ \ Volba axiomů a odvozovacích pravidel se v může v různých dokazovacích systémech Hilbertova stylu lišit.}
    
    \subsubsection*{Příklad a korektnost}
    Formule $\varphi$ je \mdef{dokazatelná} v $T$, má-li důkaz z $T$, značíme $T \vdash_{H} \varphi$.
    \smallskip
    
    Je-li $T=\emptyset$, značíme $\vdash_H \varphi$. Např. pro \mygreen{$T=\{\neg \varphi\}$} je \mygreen{$T \vdash_H \varphi \to \psi$} pro každé $\psi$.
    \mygreen{\vspace{-2mm}\begin{align*}
    1)& &\neg \varphi& & &\text{axiom z $T$} \\
    2)& &\neg \varphi& \to (\neg \psi \to \neg \varphi)& &\text{logický axiom $(i)$}\\
    3)& &\neg \psi &\to \neg \varphi& &\text{modus ponens z 1), 2)}\\
    4)& &(\neg \psi \to \neg \varphi)&\to(\varphi \to \psi)& &\text{logický axiom $(iii)$}\\
    5)& &\varphi &\to \psi&  &\text{modus ponens z 3), 4)}
    \end{align*}}
    
    \vspace{-4mm}
    {\bf \myblue{Věta}}\ \ {\it  Pro každou teorii $T$ a formuli $\varphi$,\ \ $T\vdash_H \varphi\ \Rightarrow\ T\models \varphi$.}
    \smallskip
    
    {\it \myblue{Důkaz}}
    \begin{itemize}
    \item Je-li $\varphi\in T$ nebo logický axiom, je $T \models \varphi$ (logické axiomy jsou tautologie),
    \item jestliže $T \models \varphi$ a $T \models \varphi \to \psi$, pak $T \models \psi$, tj. modus ponens je \myblue{korektní},
    \item tedy každá formule vyskytující se v důkazu z $T$ platí v $T$. \qed
\end{itemize}
    \medskip
    
    {\it \myblue{Poznámka}\ \ Platí i \myblue{úplnost}, tj. $T\models \varphi \Rightarrow T\vdash_H \varphi$ pro každou teorii $T$ a formuli $\varphi$.}

% :from slides


% \subsection*{Hilbert's calculus}
%     The \emph{Hilbert's propositional calculus} is a proof system for propositional logic where 
%     \begin{itemize}
%         \item we only use the logical connectives $\neg,\to$
%         \item we have the following (schemes of) \emph{logical axioms}:
%         \begin{enumerate}[(i)]
%             \item $\varphi \to (\psi \to \varphi)$
%             \item $(\varphi\to (\psi \to \chi)) \to ((\varphi \to \psi)\to(\varphi \to \chi))$
%             \item $(\neg \varphi \to \neg \psi)\to(\psi \to \varphi)$
%         \end{enumerate}
%         \item and the following \emph{rule of inference}:
%         $$\frac{\varphi,\ \varphi \to \psi}{\psi}$$
%         i.e. ``from $\varphi$ and $\varphi\to\psi$ infer $\psi$'' (called ``modus ponens'')
%     \end{itemize}
%     In Hilbert's calculus, a \emph{proof} of a proposition $\varphi$ from a theory $T$ is a finite sequence $\varphi_0,\dots,\varphi_n=\varphi$ of formulas such that for every $i\leq n$,
%     \begin{itemize}
%     \item $\varphi_i$ is a logical axiom, or 
%     \item $\varphi_i \in T$ (an axiom of the theory), or
%     \item $\varphi_i$ can be inferred from a pair of preceding propositions $\varphi_j$, $\varphi_k$ ($j<i,k<i$) by applying the rule of inference.
%     \end{itemize}
%     If such a proof exists, we write $T\ \vdash_H\ \varphi$.